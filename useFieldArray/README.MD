# useFieldArray

## **useFieldArray: UseFieldArrayProps**

`useFieldArray`ëŠ” Array í˜•íƒœì˜ formì„ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê¸° ìœ„í•´ ë§Œë“¤ì–´ì§„ ê°•ë ¥í•œ ê¸°ëŠ¥ì…ë‹ˆë‹¤.

### â— Props

- ë‹¤ìŒ í‘œëŠ” `useWatch`ì— ëŒ€í•œ íŒŒë¼ë¯¸í„°ì— ê´€í•œ ì •ë³´ë¥¼ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.

| Name             | Type        | Description                                                                                                                     |
| ---------------- | ----------- | ------------------------------------------------------------------------------------------------------------------------------- |
| name             | string      | `fieldArray`ì˜ ì´ë¦„ì„ ì •ì˜í•©ë‹ˆë‹¤. ì¤‘ìš”í•œ ì ì€ **ìœ ë™ì ìœ¼ë¡œ ë°”ë€ŒëŠ” í˜•íƒœì˜ `name`ì€ ê°ì§€í•˜ì§€ ëª»í•©ë‹ˆë‹¤.**                          |
| control          | Object      | `useForm`ì—ì„œ ì œê³µí•´ì£¼ëŠ” `control`ì€ `formContext`ë¥¼ ì‚¬ìš©í•  ê²½ìš°ì— `control`ì— `methods`ë¥¼ ë„£ì–´ ì‚¬ìš©í•œë‹¤.                       |
| shouldUnregister | boolean     | `fieldArray`ê°€ `unmount`ìƒíƒœì¼ ê²½ìš°ì—, êµ¬ë… ìƒíƒœë¥¼ í•´ì œí•  ê²ƒì¸ì§€ì— ê´€ë ¨ëœ option ê°’ ì…ë‹ˆë‹¤.                                     |
| keyName          | string = id | `React`ì—ì„œ ì œê³µí•˜ëŠ” `key` ì™€ ë™ì¼í•œ ê¸°ëŠ¥ì„ í•©ë‹ˆë‹¤. ë‹¤ë§Œ ë‹¤ìŒ react-hook-form ë²„ì „ì—ì„œëŠ” ì—†ì–´ì§ˆ ì˜ˆì •ì´ë¼ ì•Œ í•„ìš” ì—†ì–´ ë³´ì…ë‹ˆë‹¤. |
| rules            | Object      | `Register`ì—ì„œ ì œê³µí•˜ëŠ” `rules`ì™€ ë™ì¼í•œ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.                                                                     |

```tsx
function FieldArray() {
  const { control, register } = useForm();
  const { fields, append, prepend, remove, swap, move, insert } = useFieldArray({
    control,
    name: "test",
  });

  return (
    {fields.map((field, index) => (
      <input
        key={field.id}
        {...register(`test.${index}.value`)}
      />
    ))}
  );
}
```

### â— **Return**

| Name    | Type                                                          | Description                                                                                                                                                                                 |
| ------- | ------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| fields  | object & { id: string }                                       | í•´ë‹¹ `object`ëŠ” ë¯¸ë¦¬ ì„¤ì •í•´ë†“ì€ `defaultValue`ë‚˜ `key`ê°’ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.                                                                                                                 |
| append  | (obj: object object[], focusOptions) => void                  | í•´ë‹¹ `fieldArray`ì— ì¶”ê°€í•  inputì„ ì„¤ì •í•˜ëŠ” `function`ì…ë‹ˆë‹¤. ìë™ì ìœ¼ë¡œ êµ¬ë… ìƒíƒœë¡œ ì „í™˜ë©ë‹ˆë‹¤. , **ì¶”ê°€í•œ ë°ì´í„°ëŠ” ëª¨ë‘ í•„ìˆ˜ê°’ìœ¼ë¡œ ì „í™˜ë©ë‹ˆë‹¤.**                                          |
| prepend | (obj: object object[], focusOptions) => void                  | í•´ë‹¹ `fieldArray`ì— ì¶”ê°€í•  inputì„ ì„¤ì •í•˜ëŠ” `function`ì…ë‹ˆë‹¤. ìë™ì ìœ¼ë¡œ êµ¬ë… ìƒíƒœë¡œ ì „í™˜ë©ë‹ˆë‹¤. ë‹¨, ë°°ì—´ì˜ ë§¨ ì•ì— ì¶”ê°€ë©ë‹ˆë‹¤., **ì¶”ê°€í•œ ë°ì´í„°ëŠ” ëª¨ë‘ í•„ìˆ˜ê°’ìœ¼ë¡œ ì „í™˜ë©ë‹ˆë‹¤.**            |
| insert  | (index: number, value: object object[], focusOptions) => void | í•´ë‹¹ `fieldArray`ì˜ íŠ¹ì • ìœ„ì¹˜ì— ì¶”ê°€í•  inputì„ ì„¤ì •í•˜ëŠ” `function`ì…ë‹ˆë‹¤. ìë™ì ìœ¼ë¡œ êµ¬ë… ìƒíƒœë¡œ ì „í™˜ë©ë‹ˆë‹¤. **ì¶”ê°€í•œ ë°ì´í„°ëŠ” ëª¨ë‘ í•„ìˆ˜ê°’ìœ¼ë¡œ ì „í™˜ë©ë‹ˆë‹¤.**                                |
| swap    | (from: number, to: number) => void                            | í•´ë‹¹ `fieldArray`ì˜ íŠ¹ì • ë°ì´í„°ë“¤ì˜ ìœ„ì¹˜ë¥¼ ë°”ê¾¸ëŠ” `function`ì…ë‹ˆë‹¤.                                                                                                                         |
| move    | (from: number, to: number) => void                            | í•´ë‹¹ `fieldArray`ì˜ íŠ¹ì • ë°ì´í„°ì˜ ìœ„ì¹˜ë¥¼ ë³€ê²½í•˜ëŠ” `function`ì…ë‹ˆë‹¤.                                                                                                                         |
| update  | (index: number, obj: object) => void                          | í•´ë‹¹ `fieldArray`ì˜ ê°’ì„ ë³€ê²½í•˜ëŠ” `function`ì…ë‹ˆë‹¤. í•´ë‹¹ ë™ì‘ì€ fieldArrayì˜ unmount ì™€ remount ìƒíƒœë¥¼ ë™ë°˜í•˜ê¸° ë•Œë¬¸ì—, í•´ë‹¹ í˜„ìƒì„ ì›í•˜ì§€ ì•ŠëŠ” ê²½ìš°ì—ëŠ” `setValue`ë¡œ ê°’ì„ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤. |
| replace | (obj: object[]) => void                                       | í•´ë‹¹ `fieldArray`ì˜ ëª¨ë“  ê°’ì„ ë³€ê²½í•©ë‹ˆë‹¤.                                                                                                                                                   |
| remove  | (index?: number number[]): number                             | í•´ë‹¹ `fieldArray`ì˜ ëª¨ë“  ê°’ì„ ì œê±°í•˜ê±°ë‚˜, íŠ¹ì • `index`ì˜ ê°’ì„ ì œê±°í•©ë‹ˆë‹¤.                                                                                                                   |

### â— Rules

- `useFieldArray`ëŠ” ìë™ì ìœ¼ë¡œ ìœ ë‹ˆí¬í•œ id ê°’ì„ ìƒì„±í•©ë‹ˆë‹¤. ì´ëŠ” `React`ì˜ Renderingê³¼ ê´€ë ¨ëœ ê°’ìœ¼ë¡œ í•„ìˆ˜ë¡œ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

```jsx
// âœ… ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•´ì£¼ëŠ” field.idë¥¼ ì‚¬ìš©í•˜ì—¬ key ê°’ì„ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.:
{fields.map((field, index) => <input key={field.id} ... />)}

// âŒ key ê°’ì€ indexë¥¼ ì‚¬ìš©í•˜ë©´ ì•ˆë©ë‹ˆë‹¤.:
{fields.map((field, index) => <input key={index} ... />)}
```

- `fieldArray`ì—ì„œ ì œê³µí•˜ëŠ” `actions`(append, remove, swap...) ì™€ ê°™ì€ optionsë“¤ì€ ì¤‘ì²©í•˜ì—¬ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤.

```jsx
// âŒ ì´ëŸ°ì‹ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šì•„ì•¼ í•©ë‹ˆë‹¤.:
onClick={() => {
  append({ test: 'test' });
  remove(0);
}}

// âœ… ì¢‹ì€ ì˜ˆì‹œ.:
React.useEffect(() => {
  remove(0);
}, [remove])

onClick={() => {
  append({ test: 'test' });
}}
```

- ê°ê°ì˜ `useFieldArray`ëŠ” ìì‹ ë§Œì˜ state update ë¡œì§ì„ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì—, ì¤‘ë³µëœ ì´ë¦„ì„ ê°€ì§„ `useFieldArray`ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤.

- ëª¨ë“  `input name`ì€ ìœ ë‹ˆí¬í•œ ê°’ì„ ê°€ì§€ê³  ìˆì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì—, ì²´í¬ë°•ìŠ¤ë‚˜ ë¼ë””ì˜¤ ì²˜ëŸ¼ ê°™ì€ ì´ë¦„ì„ ê°€ì§„ formì„ ì‘ì„±í•˜ë ¤ë©´, `useController`ë‚˜ `Controller`ë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.

- **1 depthë¥¼ ê°€ì§„ ArrayëŠ” ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**

- íŠ¹ì • ê°’ì„ ë°°ì—´ì— ì¶”ê°€í•˜ëŠ” ê²½ìš°ì—ëŠ” ë¹ˆ ê°’ì„ ì¶”ê°€í•  ìˆ˜ ì—†ìœ¼ë©°, ê¸°ë³¸ì— ì„¤ì •ëœ defaultValueì— ìˆëŠ” ëª¨ë“  ê°’ë“¤ì„ ê°€ì§€ê³  ìˆì–´ì•¼ í•©ë‹ˆë‹¤.

```jsx
append(); âŒ
append({}); âŒ
append({ firstName: 'bill', lastName: 'luo' }); âœ…
```

### â— Typescript

- nameì„ êµ¬ë…ì‹œí‚¬ ê²½ìš°, íƒ€ì… ì„¤ì •ì€ `as const`ë¡œ í•´ì•¼ í•©ë‹ˆë‹¤.

```tsx
const { fields } = useFieldArray({
  name: `test.${index}.keyValue` as "test.0.keyValue",
});
```

- ìˆœí™˜ ì°¸ì¡°ëŠ” ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

- ì¤‘ì²©ëœ fieldArrayì˜ ê²½ìš°, ì•„ë˜ì™€ ê°™ì€ í˜•ì‹ìœ¼ë¡œ typeì„ ì„¤ì •í•´ì£¼ì…”ì•¼ í•©ë‹ˆë‹¤.

```tsx
<input key={field.id} {...register(`test.${index}.test` as const)} />
```

### â— Example

```tsx
//useFieldArray
import React from "react";
import { useForm, useFieldArray } from "react-hook-form";

function App() {
  const { register, control, handleSubmit, reset, trigger, setError } = useForm(
    {
      // defaultValues: {}; í•´ë‹¹ ì˜µì…˜ê°’ì„ ì´ìš©í•´ì„œ ì´ˆê¸°ì— ëœë”ë§ í•  ê°’ì„ ì„¤ì • í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    }
  );
  const { fields, append, remove } = useFieldArray({
    control,
    name: "test",
  });

  return (
    <form onSubmit={handleSubmit((data) => console.log(data))}>
      <ul>
        {fields.map((item, index) => (
          <li key={item.id}>
            <input {...register(`test.${index}.firstName`)} />
            <Controller
              render={({ field }) => <input {...field} />}
              name={`test.${index}.lastName`}
              control={control}
            />
            <button type="button" onClick={() => remove(index)}>
              Delete
            </button>
          </li>
        ))}
      </ul>
      <button
        type="button"
        onClick={() => append({ firstName: "bill", lastName: "luo" })}
      >
        append
      </button>
      <input type="submit" />
    </form>
  );
}
```

```tsx
//nested Form
import * as React from "react";
import { useForm, useFieldArray, useWatch } from "react-hook-form";

export default function App() {
  const { control, handleSubmit } = useForm();
  const { fields, append, update } = useFieldArray({
    control,
    name: "array",
  });

  return (
    <form onSubmit={handleSubmit((data) => console.log(data))}>
      {fields.map((field, index) => (
        <Edit
          key={field.id}
          control={control}
          update={update}
          index={index}
          value={field}
        />
      ))}

      <button
        type="button"
        onClick={() => {
          append({ firstName: "" });
        }}
      >
        append
      </button>
      <input type="submit" />
    </form>
  );
}

const Display = ({ control, index }) => {
  const data = useWatch({
    control,
    name: `array.${index}`,
  });
  return <p>{data?.firstName}</p>;
};

const Edit = ({ update, index, value, control }) => {
  const { register, handleSubmit } = useForm({
    defaultValues: value,
  });

  return (
    <div>
      <Display control={control} index={index} />

      <input
        placeholder="first name"
        {...register(`firstName`, { required: true })}
      />

      <button
        type="button"
        onClick={handleSubmit((data) => update(index, data))}
      >
        Submit
      </button>
    </div>
  );
};
```

### ğŸ™‹â€â™‚ï¸ ì²¨ì–¸

> `useFieldArray`ëŠ” array í˜•ì‹ì˜ inputì„ ê´€ë¦¬í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” formì´ë©°, formContextì™€ í•¨ê»˜ ì‚¬ìš©ì‹œ formContextì—ì„œ ìƒìœ„ root level ì—ì„œ ê°€ì ¸ì˜¨ controlì„ ì ìš©í•´ ì¤€ë‹¤ë©´, ì´ì „ì— ì ìš©í•´ ë‘” defaultValueë¥¼ ìë™ìœ¼ë¡œ ê°€ì ¸ì™€ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.
> ë‹¤ë§Œ, `setValue`ë¡œ í•´ë‹¹ array ê°’ì„ ì¶”ê°€í•  ìˆ˜ ì—†ìœ¼ë©°, íŠ¹ì • ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ì„œ arrayë¥¼ update í•´ì£¼ì–´ì•¼ í•œë‹¤.
